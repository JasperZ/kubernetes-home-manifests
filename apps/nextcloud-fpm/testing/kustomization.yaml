bases:
  - ../bases
patchesStrategicMerge:
  - patches/node_port.yaml
  - patches/volumes.yaml
namePrefix: testing-nextcloud
commonLabels:
  app: nextcloud
  env: testing
images:
  - name: nextcloud-fpm
    newName: nextcloud
    newTag: 16.0.3-fpm-alpine
  - name: mariadb
    newName: mariadb
    newTag: 10.4.6-bionic
  - name: redis
    newName: redis
    newTag: 5.0.5-alpine
  - name: nginx
    newName: nginx
    newTag: 1.17.1-alpine
secretGenerator:
  - name: bucket
    literals:
      - NEXTCLOUD_ADMIN_USER=admin
      - NEXTCLOUD_ADMIN_PASSWORD=AdminKey
      - MYSQL_ROOT_PASSWORD=RootKey
      - MYSQL_DATABASE=nextcloud
      - MYSQL_USER=nextcloud
      - MYSQL_PASSWORD=NextcloudKey
generatorOptions:
  labels:
    component: nextcloud
vars:
  - name: NEXTCLOUD_SERVICE_IP
    objref:
      kind: Service
      name: nextcloud
      apiVersion: v1
    fieldref:
      fieldpath: spec.loadBalancerIP
